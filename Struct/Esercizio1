#include <stdio.h>
#include <string.h>

#define MAX_AUTO 100

struct Auto {
    char modello[50];
    char marca[50];
    int cilindrata;
    float prezzo;
    int anno_immatricolazione;
    char targa[20];
};

// Funzione per stampare un'auto
void stampaAuto(struct Auto a) {
    printf("\n--- DETTAGLI AUTO ---\n");
    printf("Modello: %s\n", a.modello);
    printf("Marca: %s\n", a.marca);
    printf("Cilindrata: %d\n", a.cilindrata);
    printf("Prezzo: %.2f\n", a.prezzo);
    printf("Anno immatricolazione: %d\n", a.anno_immatricolazione);
    printf("Targa: %s\n", a.targa);
}

int main() {
    struct Auto autosalone[MAX_AUTO];
    int n, i, j;

    printf("Quante auto vuoi inserire? ");
    scanf("%d", &n);

    // Inserimento auto
    for (i = 0; i < n; i++) {
        printf("\n--- Inserisci i dati dell'auto %d ---\n", i + 1);

        printf("Modello: ");
        fflush(stdin);
        fgets(autosalone[i].modello, 50, stdin);
        autosalone[i].modello[strlen(autosalone[i].modello) - 1] = '\0';

        printf("Marca: ");
        fgets(autosalone[i].marca, 50, stdin);
        autosalone[i].marca[strlen(autosalone[i].marca) - 1] = '\0';

        printf("Cilindrata: ");
        scanf("%d", &autosalone[i].cilindrata);

        printf("Prezzo: ");
        scanf("%f", &autosalone[i].prezzo);

        printf("Anno immatricolazione: ");
        scanf("%d", &autosalone[i].anno_immatricolazione);

        printf("Targa: ");
        fflush(stdin);
        fgets(autosalone[i].targa, 20, stdin);
        autosalone[i].targa[strlen(autosalone[i].targa) - 1] = '\0';
    }

    // 1) Prezzo massimo e minimo
    float prezzoMax = autosalone[0].prezzo;
    float prezzoMin = autosalone[0].prezzo;
    int idxMax = 0, idxMin = 0;

    for (i = 1; i < n; i++) {
        if (autosalone[i].prezzo > prezzoMax) {
            prezzoMax = autosalone[i].prezzo;
            idxMax = i;
        }
        if (autosalone[i].prezzo < prezzoMin) {
            prezzoMin = autosalone[i].prezzo;
            idxMin = i;
        }
    }

    printf("\nAuto con prezzo più alto: %s (%.2f €)\n", autosalone[idxMax].modello, prezzoMax);
    printf("Auto con prezzo più basso: %s (%.2f €)\n", autosalone[idxMin].modello, prezzoMin);

    // 2) Ordinamento per anno immatricolazione
    struct Auto temp;
    for (i = 0; i < n - 1; i++) {
        for (j = i + 1; j < n; j++) {
            if (autosalone[i].anno_immatricolazione > autosalone[j].anno_immatricolazione) {
                temp = autosalone[i];
                autosalone[i] = autosalone[j];
                autosalone[j] = temp;
            }
        }
    }

    printf("\n--- AUTO ORDINATE PER ANNO ---\n");
    for (i = 0; i < n; i++) {
        printf("%d - %s (%d)\n", i + 1, autosalone[i].modello, autosalone[i].anno_immatricolazione);
    }

    // 3) Visualizzare auto con prezzo maggiore di uno scelto
    float prezzoScelto;
    printf("\nInserisci un prezzo minimo: ");
    scanf("%f", &prezzoScelto);

    printf("\nAuto con prezzo >= %.2f:\n", prezzoScelto);
    for (i = 0; i < n; i++) {
        if (autosalone[i].prezzo >= prezzoScelto) {
            printf("%s - %.2f\n", autosalone[i].modello, autosalone[i].prezzo);
        }
    }

    // 4) Ricerca per targa
    char targaCercata[20];
    printf("\nInserisci la targa da cercare: ");
    fflush(stdin);
    fgets(targaCercata, 20, stdin);
    targaCercata[strlen(targaCercata) - 1] = '\0';

    int trovata = 0;
    for (i = 0; i < n; i++) {
        if (strcmp(autosalone[i].targa, targaCercata) == 0) {
            printf("\nAuto trovata:\n");
            stampaAuto(autosalone[i]);
            trovata = 1;
        }
    }
    if (!trovata)
        printf("Nessuna auto trovata con targa %s\n", targaCercata);

    // 5) Media dei prezzi
    float somma = 0;
    for (i = 0; i < n; i++) {
        somma += autosalone[i].prezzo;
    }
    float media = somma / n;
    printf("\nPrezzo medio delle auto: %.2f\n", media);

    // 6) Auto con anno scelto
    int annoScelto;
    printf("\nInserisci un anno da cercare: ");
    scanf("%d", &annoScelto);

    printf("\nAuto immatricolate nel %d:\n", annoScelto);
    int trovateAnno = 0;
    for (i = 0; i < n; i++) {
        if (autosalone[i].anno_immatricolazione == annoScelto) {
            stampaAuto(autosalone[i]);
            trovateAnno = 1;
        }
    }
    if (!trovateAnno)
        printf("Nessuna auto trovata per l'anno %d.\n", annoScelto);

    return 0;
}